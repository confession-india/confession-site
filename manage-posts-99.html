<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin - Confess India</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-900 text-white p-6">
    <div id="adminUI" class="hidden max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold mb-6 text-purple-400 border-b border-gray-800 pb-4">Moderation Panel</h1>
        <div id="feed" class="space-y-4"></div>
    </div>
    <script>
        const PIN = "2122"; // <--- CHANGE THIS
        if(prompt("Admin PIN:") !== PIN) { window.location.href="index.html"; } 
        else { document.getElementById('adminUI').classList.remove('hidden'); start(); }

        function start() {
            const firebaseConfig = { apiKey: "AIzaSyA8JIiJ5sRc5Fxy6qcYAXD8_nA8ELOBwkI", authDomain: "confession-india.firebaseapp.com", projectId: "confession-india", storageBucket: "confession-india.firebasestorage.app", messagingSenderId: "345080016810", appId: "1:345080016810:web:3032f570077ea8d6dd45d3" };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();

            db.collection('confessions').orderBy('timestamp', 'desc').onSnapshot(snap => {
                const feed = document.getElementById('feed');
                feed.innerHTML = '';
                snap.forEach(doc => {
                    const p = doc.data();
                    const div = document.createElement('div');
                    div.className = "bg-gray-800 p-4 rounded-xl flex justify-between items-center border " + (p.reportCount > 0 ? 'border-orange-500' : 'border-gray-700');
                    div.innerHTML = `
                        <div>
                            <span class="text-[10px] font-bold uppercase bg-gray-700 px-2 py-1 rounded">Reports: ${p.reportCount || 0}</span>
                            <p class="text-sm font-bold mt-2 text-purple-300">${p.username}</p>
                            <p class="text-xs text-gray-400 mt-1">${p.content}</p>
                        </div>
                        <button onclick="del('${doc.id}')" class="bg-red-600 px-4 py-2 rounded text-xs font-bold">DELETE</button>
                    `;
                    feed.appendChild(div);
                });
            });
            window.del = (id) => { if(confirm("Delete?")) db.collection('confessions').doc(id).delete(); }
        }
    </script>
</body>
</html>
